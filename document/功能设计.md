



# 1	ç”¨æˆ·æ¨¡å—

## 1.1	åŠŸèƒ½æ¦‚è¿°

### 1.1.1	æ³¨å†ŒåŠŸèƒ½

##### â­•ä½¿ç”¨é‚®ç®±å‘é€éªŒè¯ç 

<br>

##### ğŸ“Œä½¿ç”¨ SMS å‘é€æ‰‹æœºéªŒè¯ç ç™»å½•

- **å‰ææ¡ä»¶**ï¼šéœ€è¦å¼€å‘èµ„æ ¼è®¤è¯

<br>

----

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>


### 1.1.2	ç™»å½•åŠŸèƒ½

##### â­•ä½¿ç”¨é‚®ç®±åœ°å€é…åˆå¯†ç ç™»å½•

<br>

##### â­•é€šè¿‡é‚®ç®±å’ŒéªŒè¯ç é‡æ–°è®¾ç½®å¯†ç 

<br>

##### â­•é€€å‡ºç™»å½•

<br>

##### â­•å¯¹éœ€è¦ç™»å½•æ‰èƒ½ä½¿ç”¨çš„åŠŸèƒ½è¿›è¡Œæ‹¦æˆª

- **åŠŸèƒ½æè¿°**ï¼šå¯¹äºéœ€è¦ç™»å½•æ‰èƒ½ä½¿ç”¨çš„åŠŸèƒ½ï¼Œåœ¨è®¿é—®å‰å…ˆæ£€æŸ¥ç”¨æˆ· tokenï¼Œtoken å¦‚æœä¸å­˜åœ¨æˆ–è€…è¿‡æœŸï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚

- **å®ç°æ€è·¯**ï¼šé€šè¿‡ gateway å®ç°ä¸å‰ç«¯å“åº”æ‹¦æˆªå™¨å®ç°

<br>

##### â—ä½¿ç”¨å¾®ä¿¡ã€è…¾è®¯ä»¥åŠå¾®åšæ‰«ç ç™»å½•

- **å‰ææ¡ä»¶**ï¼šéœ€è¦å¼€å‘èµ„æ ¼è®¤è¯

<br>

##### ğŸ“Œä½¿ç”¨æ‰‹æœºå·ç ä¸éªŒè¯ç ç™»å½•

- **å‰ææ¡ä»¶**ï¼šéœ€è¦å¼€å‘èµ„æ ¼è®¤è¯

<br>

##### ğŸ“Œé‡å¤ç™»å½•åˆ¤æ–­

- **å®ç°æ€è·¯**ï¼šå¯ä»¥ä½¿ç”¨ redis è¿›è¡Œåˆ¤æ–­ï¼Œç”¨æˆ·ç™»å½•ååœ¨ redis ä¸­ç¼“å­˜ç”¨æˆ·ç›¸å…³æ•°æ®ï¼Œä½¿ç”¨ id ä½œä¸º keyã€‚å¦‚æœç™»å½•æ—¶ï¼Œkey å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆè¯´æ˜å·²ç»æˆåŠŸç™»å½•ã€‚

<br>

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>
### 1.1.3	ä¿¡æ¯è®¾ç½®åŠŸèƒ½

##### â­•ä¿®æ”¹åŸºæœ¬ä¿¡æ¯<span id="1.2.3-1" style="display:none"></span>

<br>

##### â­•ä¿®æ”¹ã€ç»‘å®šé‚®ç®±åœ°å€

<br>

##### ğŸ“Œä¿®æ”¹ã€ç»‘å®šæ‰‹æœºå·

<br>

##### ğŸ“Œä¿®æ”¹ã€ç»‘å®šç¤¾äº¤è´¦å·

<br>

##### â—åˆ é™¤è´¦å·ä»¥åŠæ‰€æœ‰å…³è”æ•°æ®

- å®ç°æ€è·¯

<br>

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

### 1.1.4	ä¼šå‘˜åŠŸèƒ½

##### å‡çº§ä¸ºè¶…çº§ä¼šå‘˜

- éœ€è¦è°ƒç”¨ä»˜è´¹æ¨¡å— API
- ä¼šå‘˜æœ‰ä¿å­˜ç¬”è®°æ•°é‡ä¸Šé™ï¼ˆæœªå¼€é€šä¼šå‘˜ä¸Šé™ä¸º10ï¼‰

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

### 1.1.5	ç¬”è®°æ–‡ä»¶å¤¹åŠŸèƒ½

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

### 1.1.6	æ”¶è—å¤¹åŠŸèƒ½

----

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

### 1.1.6	å…³æ³¨åŠŸèƒ½

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

## 1.2	é‡è¦åŠŸèƒ½è¯¦ç»†è®¾è®¡

### 1.2.1	å¤´åƒä¸Šä¼ 

##### é—®é¢˜æ¥æº

[1.2.3 ç”¨æˆ·è®¾ç½® â†’ ä¿®æ”¹åŸºæœ¬ä¿¡æ¯](#1.2.3-1)

<br>

##### åŠŸèƒ½é‡ç‚¹ â€”â€” ç”¨æˆ·å¤šæ¬¡ä¸Šä¼ å¤´åƒï¼Œæˆ–è€…ä¸Šä¼ å¤´åƒåæœªä¿å­˜ç›´æ¥é€€å‡º

###### âŒæ–¹æ¡ˆä¸€

1. å‰ç«¯æ¯æ¬¡ä¸Šä¼ å¤´åƒåï¼Œä¿å­˜è¿”å›çš„ `imageUrl` åˆ°æ•°ç»„ `imageUrls[]` ä¸­ã€‚
2. æ¯æ¬¡æäº¤è¡¨å•åï¼Œè®°å½•æ­¤æ¬¡æäº¤çš„ `imageUrl`ã€‚
3. é€€å‡ºé¡µé¢æ—¶ï¼Œåœ¨ Vue é’©å­å‡½æ•° `beforeDestroy()` ä¸­æ£€æŸ¥è¡¨å•æ˜¯å¦è¢«æäº¤è¿‡ï¼ˆé€šè¿‡è®¾ç½® flagï¼‰ã€‚
4. ä»  `imageUrls[]` ä¸­ å»é™¤æœ€åä¸€æ¬¡æäº¤è¡¨å•æ—¶ä¿å­˜çš„ `imageUrl`ã€‚
5. åˆ é™¤ ä¸­çš„æ‰€æœ‰å›¾ç‰‡ ã€‚

**é—®é¢˜**ï¼šæµè§ˆå™¨æˆ–é¡µé¢è¢«ç›´æ¥å…³é—­æ—¶ï¼Œ`beforeDestroy()` ä¸ä¼šè¢«è°ƒç”¨ï¼Œå¯ä»¥ä½¿ç”¨ `window.onbeforeunload()` ï¼Œä½†æ˜¯å®ç°è¿‡äºå¤æ‚[^1.3.1-1]ã€‚

![æ—¶åºå›¾â€”â€”æ–¹æ¡ˆä¸€](img/image-20220122143837498.png)

###### âŒæ–¹æ¡ˆäºŒ

1. åœ¨æäº¤è¡¨å•æ—¶æ£€æŸ¥æ˜¯å¦ä¸Šä¼ çš„å›¾ç‰‡ã€‚
2. å¦‚æœä¸Šä¼ äº†å›¾ç‰‡ï¼Œåˆ™å…ˆè°ƒç”¨ `ossApi.uploadFile()` å›¾ç‰‡ä¸Šä¼ åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œå¹¶å°†è¿”å› URL æ·»åŠ åˆ°è¡¨å•ä¸­ã€‚
3. service-user æ›´æ–°ç”¨æˆ·å¤´åƒå­—æ®µæ•°æ®ã€‚
4. å¦‚æœä¹‹å‰è®¾ç½®è¿‡å¤´åƒï¼Œè°ƒç”¨ `AliyunOssClient.deleteFile()` åˆ é™¤åŸæœ¬çš„å¤´åƒã€‚

![æ—¶åºå›¾â€”â€”æ–¹æ¡ˆäºŒ](img/image-20220122181045343.png)

**é—®é¢˜**ï¼šæ— æ³•ç”Ÿæˆå¤´åƒé¢„è§ˆ

###### â­•æ–¹æ¡ˆä¸‰

1. é€šè¿‡ `ossApi.uploadFileTemporary()` ä¸Šä¼ æ–‡ä»¶åˆ° OSS æ–‡ä»¶çš„ä¸´æ—¶ç›®å½•ã€‚
2. å°†è¿”å›çš„ imageUrl æ·»åŠ åˆ°è¡¨å•ä¿¡æ¯
3. service-user ç›‘æµ‹åˆ° avatar å­—æ®µå‘ç”Ÿå˜åŒ–ï¼Œè¿œç¨‹è°ƒç”¨ `AliyunOSSController.alterFileLocation()`
4. `AliyunOSSController.alterFileLocation()` ä¼šå¤åˆ¶ä¸Šä¼ çš„æ–‡ä»¶åˆ°éä¸´æ—¶ç›®å½•ä¸­ã€‚
5. **å®šæœŸåˆ é™¤ä¸´æ—¶ç›®å½•ä¸­çš„æ–‡ä»¶æ•°æ®**ã€‚

å…¶ä»–ï¼šè¿˜éœ€è¦åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡ä¸Šä¼ å¤´åƒï¼Œå¦‚æœä¸æ˜¯ï¼Œéœ€è¦åˆ é™¤æ—§å¤´åƒ

<br>

---

[^1.3.1-1]: `window.onbeforeunload()` ä¸­åªèƒ½ä½¿ç”¨åŸç”Ÿ ajax å‘é€è¯·æ±‚ï¼Œæ•°æ®åˆ™éœ€è¦å…ˆé€šè¿‡ cookie æˆ–è€… localstorage ä¿å­˜ï¼Œæ‰èƒ½è·å–ã€‚

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

## 1.3	æ•°æ®è¡¨

##### ç”¨æˆ·ä¿¡æ¯è¡¨ï¼ˆuser_infoï¼‰

###### å­—æ®µ

| å­—æ®µå   | å­—æ®µç±»å‹         | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š            | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜ |
| -------- | ---------------- | -------- | ------ | --------------- | ----------- | -------- |
| id       | varchar(32)      | NOT NULL |        | ç”¨æˆ·id          | PRIMARY KEY |          |
| nickname | varchar(50)      |          | NULL   | æ˜µç§°            |             |          |
| sex      | tinyint unsigned |          | NULL   | æ€§åˆ« 0 ç”·ï¼Œ1 å¥³ |             |          |
| birthday | datetime         |          | NULL   | å¹´é¾„            |             |          |
| avatar   | varchar(255)     |          | NULL   | ç”¨æˆ·å¤´åƒ        |             |          |
| sign     | varchar(100)     |          | NULL   | ç”¨æˆ·ç­¾å        |             |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š       | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ---------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | ç”¨æˆ·ä¿¡æ¯è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```mysql
CREATE TABLE `user_info` (
  `id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ·id',
  `nickname` varchar(50) DEFAULT NULL COMMENT 'æ˜µç§°',
  `sex` tinyint unsigned DEFAULT NULL COMMENT 'æ€§åˆ« 0 ç”·ï¼Œ1 å¥³',
  `birthday` irthdaydatetime DEFAULT NULL COMMENT 'å¹´é¾„',
  `avatar` varchar(255) DEFAULT NULL COMMENT 'ç”¨æˆ·å¤´åƒ',
  `sign` varchar(100) DEFAULT NULL COMMENT 'ç”¨æˆ·ç­¾å',
  `is_deleted` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ç”¨æˆ·ä¿¡æ¯è¡¨';
```

<br>

##### ç”¨æˆ·ç™»å½•éªŒè¯è¡¨ï¼ˆuser_checkï¼‰  

###### å­—æ®µ

| å­—æ®µå      | å­—æ®µç±»å‹     | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š                                          | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜ |
| ----------- | ------------ | -------- | ------ | --------------------------------------------- | ----------- | -------- |
| id          | varchar(32)  | NOT NULL |        | ç”¨æˆ· id                                       | PRIMARY KEY |          |
| mobile      | varchar(11)  |          | NULL   | æ‰‹æœºå·                                        | UNIQUE KEY  |          |
| email       | varchar(100  |          | NULL   | é‚®ç®±åœ°å€                                      | UNIQUE KEY  |          |
| openid_wx   | varchar(128) |          | NULL   | å¾®ä¿¡ openid                                   | UNIQUE KEY  |          |
| openid_qq   | varchar(128) |          | NULL   | QQ openid                                     | UNIQUE KEY  |          |
| openid_wb   | varchar(128) |          | NULL   | å¾®åš ioenid                                   | UNIQUE KEY  |          |
| password    | varchar(255) |          | NULL   | å¯†ç                                           |             |          |
| is_disabled | tinyint(1)   | NOT NULL | 0      | æ˜¯å¦ç¦ç”¨ã€‚1ï¼ˆtrueï¼‰å·²ç¦ç”¨ï¼Œ0ï¼ˆfalseï¼‰æœªç¦ç”¨ã€‚ |             |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š           | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | -------------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | ç”¨æˆ·ç™»å½•éªŒè¯è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```mysql
CREATE TABLE `user_check` (
  `id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ·id',
  `mobile` varchar(11) DEFAULT NULL COMMENT 'æ‰‹æœºå·',
  `email` varchar(100) DEFAULT NULL COMMENT 'é‚®ç®±åœ°å€',
  `openid_wx` varchar(128) DEFAULT NULL COMMENT 'å¾®ä¿¡openid',
  `openid_qq` varchar(128) DEFAULT NULL COMMENT 'QQ openid',
  `openid_wb` varchar(128) DEFAULT NULL COMMENT 'å¾®åš ioenid',
  `password` varchar(255) DEFAULT NULL COMMENT 'å¯†ç ',
  `is_disabled` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦ç¦ç”¨ 1ï¼ˆtrueï¼‰å·²ç¦ç”¨ï¼Œ  0ï¼ˆfalseï¼‰æœªç¦ç”¨',
  `is_deleted` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_mobile` (`mobile`),
  UNIQUE KEY `uk_email` (`email`),  
  UNIQUE KEY `uk_openid_wx` (`openid_wx`)
  UNIQUE KEY `uk_openid_qq` (`openid_qq`)
  UNIQUE KEY `uk_openid_wb` (`openid_wb`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ç”¨æˆ·ç™»å½•éªŒè¯è¡¨';
```

<br>

##### ç”¨æˆ·è¶…çº§ä¼šå‘˜ä¿¡æ¯è¡¨ï¼ˆuser_ultraï¼‰

###### å­—æ®µ

| å­—æ®µå      | å­—æ®µç±»å‹    | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š                               | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜ |
| ----------- | ----------- | -------- | ------ | ---------------------------------- | ----------- | -------- |
| id          | varchar(32) | NOT NULL |        | ç”¨æˆ·id                             | PRIMARY KEY |          |
| is_ultra    | tinyint(1)  | NOT NULL | 0      | æ˜¯å¦ä¸ºè¶…çº§ä¼šå‘˜ï¼Œ1ï¼ˆæ˜¯ï¼‰ï¼Œ0ï¼ˆä¸æ˜¯ï¼‰ |             |          |
| gmt_expired | datetime    |          | NULL   | è¶…çº§ä¼šå‘˜åˆ°æœŸæ—¶é—´                   |             |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š               | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ------------------ | -------- |
| `InnoDB`   | utf8mb4      | utf8mb4_0900_ai_ci | ç”¨æˆ·è¶…çº§ä¼šå‘˜ä¿¡æ¯è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```mysql
CREATE TABLE `user_member` (
  `id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ·id',
  `is_ultra` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦ä¸ºè¶…çº§ä¼šå‘˜ï¼Œ1ï¼ˆæ˜¯ï¼‰ï¼Œ0ï¼ˆä¸æ˜¯ï¼‰',
  `gmt_expired` datetime DEFAULT NULL COMMENT 'è¶…çº§ä¼šå‘˜åˆ°æœŸæ—¶é—´',
  `is_deleted` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ç”¨æˆ·è¶…çº§ä¼šå‘˜ä¿¡æ¯è¡¨';
```

<br>

##### ç”¨æˆ·ç¬”è®°æ–‡ä»¶å¤¹è¡¨ï¼ˆuser_nfolderï¼‰

###### å­—æ®µ

| å­—æ®µå             | å­—æ®µç±»å‹     | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š               | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜                                             |
| ------------------ | ------------ | -------- | ------ | ------------------ | ----------- | ---------------------------------------------------- |
| id                 | varchar(32)  | NOT NULL |        | æ–‡ä»¶å¤¹id           | PRIMARY KEY |                                                      |
| user_id            | varchar(32)  | NOT NULL |        | ç”¨æˆ·id             | KEY         |                                                      |
| folder_name        | varchar(50)  | NOT NULL |        | æ–‡ä»¶å¤¹å           |             |                                                      |
| note_count         | int          | NOT NULL | 0      | æ–‡ä»¶å¤¹ä¸­ç¬”è®°çš„æ•°é‡ |             |                                                      |
| folder_description | varchar(100) |          | NULL   | æ–‡ä»¶å¤¹ç®€ä»‹         |             |                                                      |
| is_default         | tinyint(1)   | NOT NULL | 0      | æ˜¯å¦ä¸ºé»˜è®¤æ–‡ä»¶å¤¹   |             | æ³¨å†Œæ—¶ç¬¬ä¸€ä¸ªåˆ›å»ºçš„æ–‡ä»¶å¤¹ï¼Œ<br>ç”¨æˆ·ä¸å¯åˆ é™¤é»˜è®¤æ–‡ä»¶å¤¹ |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š             | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ---------------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | ç”¨æˆ·ç¬”è®°æ–‡ä»¶å¤¹è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```mysql
CREATE TABLE `user_nfolder` (
  `id` varchar(32) NOT NULL COMMENT 'æ–‡ä»¶å¤¹id',
  `user_id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ·id',
  `folder_name` varchar(50) NOT NULL COMMENT 'æ–‡ä»¶å¤¹å',
  `note_count` int NOT NULL DEFAULT '0' COMMENT 'æ–‡ä»¶å¤¹ä¸­ç¬”è®°çš„æ•°é‡',
  `folder_description` varchar(100) DEFAULT NULL COMMENT 'æ–‡ä»¶å¤¹ç®€ä»‹',
  `is_default` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦ä¸ºé»˜è®¤æ–‡ä»¶å¤¹',
  `is_deleted` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ç”¨æˆ·æ–‡ä»¶å¤¹è¡¨';
```

###### æ³¨æ„

- ä¸€ä¸ªç”¨æˆ·æœ‰å¤šä¸ªç¬”è®°æ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªç¬”è®°æ–‡ä»¶å¤¹ä¸­æœ‰å¤šä¸ªç¬”è®°ï¼Œä½†æ˜¯ä¸€ç¯‡ç¬”è®°åªå±äºä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚
- é»˜è®¤ç¬”è®°æ–‡ä»¶å¤¹çš„ id ä¸ user_id ç›¸åŒã€‚

<br>

##### ç”¨æˆ·æ”¶è—æ–‡ä»¶å¤¹è¡¨ï¼ˆuser_cfolderï¼‰

###### å­—æ®µ

| å­—æ®µå             | å­—æ®µç±»å‹     | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š               | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜                                             |
| ------------------ | ------------ | -------- | ------ | ------------------ | ----------- | ---------------------------------------------------- |
| id                 | varchar(32)  | NOT NULL |        | æ”¶è—å¤¹id           | PRIMARY KEY |                                                      |
| user_id            | varchar(32)  | NOT NULL |        | ç”¨æˆ·id             | KEY         |                                                      |
| folder_name        | varchar(50)  | NOT NULL |        | æ”¶è—å¤¹å           |             |                                                      |
| note_count         | int          | NOT NULL | 0      | æ”¶è—å¤¹ä¸­ç¬”è®°çš„æ•°é‡ |             |                                                      |
| folder_description | varchar(100) |          | NULL   | æ”¶è—å¤¹ç®€ä»‹         |             |                                                      |
| is_default         | tinyint(1)   | NOT NULL | 0      | æ˜¯å¦ä¸ºé»˜è®¤æ”¶è—å¤¹   |             | æ³¨å†Œæ—¶ç¬¬ä¸€ä¸ªåˆ›å»ºçš„æ”¶è—å¤¹ï¼Œ<br>ç”¨æˆ·ä¸å¯åˆ é™¤é»˜è®¤æ”¶è—å¤¹ |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š             | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ---------------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | ç”¨æˆ·æ”¶è—æ–‡ä»¶å¤¹è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```mysql
CREATE TABLE `user_cfolder` (
  `id` varchar(32) NOT NULL COMMENT 'æ–‡ä»¶å¤¹id',
  `user_id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ·id',
  `folder_name` varchar(50) NOT NULL COMMENT 'æ”¶è—å¤¹å',
  `note_count` int NOT NULL DEFAULT '0' COMMENT 'æ”¶è—å¤¹ä¸­ç¬”è®°çš„æ•°é‡',
  `folder_description` varchar(100) DEFAULT NULL COMMENT 'æ”¶è—å¤¹ç®€ä»‹',
  `is_default` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦ä¸ºé»˜è®¤æ”¶è—å¤¹',
  `is_deleted` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ç”¨æˆ·æ–‡ä»¶å¤¹è¡¨';
```

- é»˜è®¤æ”¶è—å¤¹çš„ id ä¸ user_id ç›¸åŒã€‚

<br>

##### ç”¨æˆ·å…³æ³¨è¡¨ï¼ˆuser_followï¼‰

###### å­—æ®µ

| å­—æ®µå        | å­—æ®µç±»å‹    | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š           | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜ |
| ------------- | ----------- | -------- | ------ | -------------- | ----------- | -------- |
| id            | varchar(32) | NOT NULL |        | id             | PRIMARY KEY |          |
| user_id       | varchar(32) | NOT NULL |        | ç”¨æˆ·id         | KEY         |          |
| follow_userId | varchar(32) | NOT NULL |        | è¢«å…³æ³¨çš„ç”¨æˆ·id |             |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š             | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ---------------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | ç”¨æˆ·æ”¶è—æ–‡ä»¶å¤¹è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```mysql
CREATE TABLE `user_follow` (
  `id` varchar(32) NOT NULL COMMENT 'id',
  `user_id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ· id',
  `follow_userId` varchar(32) NOT NULL COMMENT 'è¢«å…³æ³¨çš„ç”¨æˆ· id',
  `is_deleted` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ç”¨æˆ·å…³æ³¨è¡¨';
```

<br>

##### ç”¨æˆ·åŠ¨æ€è¡¨ï¼ˆuser_dynamicï¼‰

###### å­—æ®µ

| å­—æ®µå       | å­—æ®µç±»å‹     | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š                                             | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜ |
| ------------ | ------------ | -------- | ------ | ------------------------------------------------ | ----------- | -------- |
| id           | varchar(32)  | NOT NULL |        | id                                               | PRIMARY KEY |          |
| user_id      | varchar(32)  | NOT NULL |        | ç”¨æˆ·id                                           | KEY         |          |
| dynamic_type | tinyint      | NOT NULL |        | åŠ¨æ€ç±»å‹ï¼ˆæš‚æ—¶åŒ…æ‹¬ï¼š1-ç¬”è®°å…¬å¼€ï¼Œ2-è¯„è®ºï¼Œ3-å…³æ³¨ï¼‰ |             |          |
| dynamic_id   | varchar(32)  | NOT NULL |        | åŠ¨æ€å¯¹åº”çš„æ•°æ®ID                                 |             |          |
| description  | varchar(100) | NOT NULL |        | åŠ¨æ€æè¿°                                         |             |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š             | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ---------------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | ç”¨æˆ·æ”¶è—æ–‡ä»¶å¤¹è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```mysql
CREATE TABLE `user_dynamic` (
  `id` varchar(32) NOT NULL COMMENT 'id',
  `user_id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ· id',
  `dynamic_type` tinyint NOT NULL COMMENT 'åŠ¨æ€ç±»å‹ï¼ˆæš‚æ—¶åŒ…æ‹¬ï¼š1-ç¬”è®°å…¬å¼€ï¼Œ2-è¯„è®ºï¼Œ3-å…³æ³¨ï¼‰',
  `dynamic_id` varchar(32) NOT NULL COMMENT 'åŠ¨æ€å¯¹åº”çš„æ•°æ®ID',
  `description` varchar(100) NOT NULL COMMENT 'åŠ¨æ€æè¿°',
  `is_deleted` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ç”¨æˆ·åŠ¨æ€è¡¨';
```

<br>

##### â—ç”¨æˆ·æ•°æ®è¡¨

<br>

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>
# 2	ç¬”è®°æ¨¡å—

## 2.1	åŠŸèƒ½æ¦‚è¿°

### 2.1.1	ç”¨æˆ·æ–°å¢ç¬”è®°

##### â—æ–°å¢ç¬”è®°

- ä½¿ç”¨ markdown ç¼–è¾‘å™¨ã€‚

<br>

##### â—ç¬”è®°ä¸Šä¼ å›¾ç‰‡

<br>

##### â—è‡ªåŠ¨ä¿å­˜è‰ç¨¿

<br>

##### â—è®¾ç½®ç¬”è®°æ ‡ç­¾

<br>

##### â—è®¾ç½®ç¬”è®°æ˜¯å¦å…¬å¼€

- ç¼–è¾‘æ—¶æ·»åŠ å…¬å¼€ç¡®è®¤æ¡†ï¼Œå°†ç¬”è®°åœ¨ç½‘ç«™é¦–é¡µå…¬å¼€ï¼Œå³åˆ†äº«åŠŸèƒ½ã€‚

<br>

##### â—è®¾ç½®ç¬”è®°åˆ†ç»„

<br>

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

### 2.1.2	ç”¨æˆ·ç¬”è®°ç®¡ç†

##### â—åˆ é™¤ç¬”è®°

- å°†ç¬”è®°è®¾ç½®ä¸ºé€»è¾‘åˆ é™¤çŠ¶æ€ï¼Œå¹¶åœ¨å›æ”¶ç«™ä¸­ä¿å­˜ 30 å¤©ã€‚

<br>

##### â—ä¿®æ”¹ç¬”è®°å†…å®¹

<br>

##### â—ä¿®æ”¹ç¬”è®°çš„å…¬å¼€çŠ¶æ€

- åœ¨ç¬”è®°é¡µè¿›è¡Œä¿®æ”¹ã€‚

<br>

##### â—ç¬”è®°å›æ”¶ç«™

- å°†ç¬”è®°å½»åº•åˆ é™¤ï¼Œæˆ–è€…ä»å›æ”¶ç«™ä¸­æ¢å¤ã€‚

<br>

##### ä¿®æ”¹ç¬”è®°çš„åˆ†ç»„

- å»ºç«‹æ–‡ä»¶å¤¹ï¼Œæ¯ä¸ªç¬”è®°éƒ½å¿…é¡»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€å±çš„æ–‡ä»¶å¤¹ã€‚

<br>

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

### 2.1.3	ç¬”è®°æ–‡ä»¶å¤¹ç®¡ç†

##### â—æ–°å¢ç¬”è®°æ–‡ä»¶å¤¹

<br>

##### â—ä¿®æ”¹ç¬”è®°æ–‡ä»¶å¤¹ä¿¡æ¯

<br>

##### â—åˆ é™¤ç¬”è®°æ–‡ä»¶å¤¹

<br>

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

### 2.1.4	ç¬”è®°å…¬å¼€åçš„ç›¸å…³åŠŸèƒ½

##### â—ç¬”è®°è¯„è®º

<br>

##### â—ç¬”è®°ç‚¹èµ

<br>

##### â—ç¬”è®°æ”¶è—

<br>

##### â—æ·»åŠ åˆ°æ”¶è—å¤¹

<br>

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

## 2.2	é‡è¦åŠŸèƒ½è¯¦ç»†è®¾è®¡

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

## 2.3	æ•°æ®è¡¨

##### ç¬”è®°æ­£æ–‡è¡¨ï¼ˆnote_textï¼‰

###### å­—æ®µ

| å­—æ®µå | å­—æ®µç±»å‹    | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š         | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜ |
| ------ | ----------- | -------- | ------ | ------------ | ----------- | -------- |
| id     | varchar(32) | NOT NULL |        | ç¬”è®°ID       | PRIMARY KEY |          |
| text   | text        |          |        | ç¬”è®°æ­£æ–‡å†…å®¹ |             |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š       | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ---------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | ç¬”è®°æ­£æ–‡è¡¨ |          |

###### å»ºè¡¨è¯­å¥ 

```sql
CREATE TABLE `note_text` (
  `id` varchar(32) NOT NULL COMMENT 'ç¬”è®°ID',
  `text` text COMMENT 'ç¬”è®°æ­£æ–‡å†…å®¹',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ç¬”è®°æ­£æ–‡è¡¨';
```

<br>

##### ç¬”è®°ä¿¡æ¯è¡¨ï¼ˆnote_infoï¼‰

###### å­—æ®µ

| å­—æ®µå           | å­—æ®µç±»å‹        | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š                               | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜                                           |
| ---------------- | --------------- | -------- | ------ | ---------------------------------- | ----------- | -------------------------------------------------- |
| id               | varchar(32)     | NOT NULL |        | ç¬”è®°ID                             | PRIMARY KEY |                                                    |
| user_id          | varchar(32)     | NOT NULL |        | ç”¨æˆ·IDï¼ˆå‘å¸ƒè€…IDï¼‰                 | KEY         |                                                    |
| note_folder_id   | varchar(32)     | NOT NULL |        | æ–‡ä»¶å¤¹ID                           | KEY         |                                                    |
| title            | varchar(50)     |          | NULL   | ç¬”è®°æ ‡é¢˜                           | KEY         |                                                    |
| preview          | varchar(150)    |          | NULL   | ç¬”è®°é¢„è§ˆ                           |             | å¦‚æœé¢„è§ˆçš„é•¿åº¦è¶…è¿‡60å­—ï¼Œåˆ™åœ¨æœ«å°¾æ‰‹åŠ¨æ·»åŠ ç¬¦å· `â€¦`ã€‚ |
| cover            | varchar(255)    | NOT NULL | NULL   | ç¬”è®°å°é¢                           |             |                                                    |
| length           | int unsigned    | NOT NULL | 0      | ç¬”è®°é•¿åº¦                           |             |                                                    |
| likes            | bigint unsigned | NOT NULL | 0      | ç‚¹èµæ•°                             |             |                                                    |
| collection_count | bigint unsigned | NOT NULL | 0      | æ”¶è—æ•°                             |             |                                                    |
| comment_count    | bigint unsigned | NOT NULL | 0      | è¯„è®ºæ•°                             |             |                                                    |
| status           | tinyint(1)      | NOT NULL | 0      | 0 è‰ç¨¿çŠ¶æ€ï¼Œ1 å®ŒæˆçŠ¶æ€ï¼Œ2 å‘å¸ƒçŠ¶æ€ |             |                                                    |
| version          | bigint unsigned | NOT NULL | 1      | ä¹è§‚é”                             |             |                                                    |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š       | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ---------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | ç¬”è®°ä¿¡æ¯è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```sql
CREATE TABLE `note_info` (
  `id` varchar(32) NOT NULL COMMENT 'ç¬”è®°ID',
  `user_id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ·IDï¼ˆå‘å¸ƒè€…IDï¼‰',
  `note_folder_id` varchar(32) NOT NULL COMMENT 'æ–‡ä»¶å¤¹ID',
  `title` varchar(50) DEFAULT NULL COMMENT 'ç¬”è®°æ ‡é¢˜',
  `preview` varchar(150) DEFAULT NULL COMMENT 'ç¬”è®°é¢„è§ˆ',
  `cover` varchar(255) DEFAULT NULL COMMENT 'ç¬”è®°å°é¢',
  `length` int unsigned NOT NULL DEFAULT '0' COMMENT 'ç¬”è®°é•¿åº¦',
  `likes` bigint unsigned NOT NULL DEFAULT '0' COMMENT 'ç‚¹èµæ•°',
  `collection_count` bigint unsigned NOT NULL DEFAULT '0' COMMENT 'æ”¶è—æ•°',
  `comment_count` bigint unsigned NOT NULL DEFAULT '0' COMMENT 'è¯„è®ºæ•°',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'å‘å¸ƒçŠ¶æ€ 1ï¼ˆtrueï¼‰å‘å¸ƒï¼Œ 0ï¼ˆfalseï¼‰æœªå‘å¸ƒ',
  `version` bigint unsigned NOT NULL DEFAULT '1' COMMENT 'ä¹è§‚é”',
  `is_deleted` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_title` (`title`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_note_folder_id` (`note_folder_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ç¬”è®°ä¿¡æ¯è¡¨';
```

<br>

##### ç¬”è®°â€”ç”¨æˆ·â€”æ”¶è—å¤¹å…³ç³»è¡¨ï¼ˆnote_user_collectionï¼‰

###### å­—æ®µ

| å­—æ®µå               | å­—æ®µç±»å‹    | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š     | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜ |
| -------------------- | ----------- | -------- | ------ | -------- | ----------- | -------- |
| id                   | varchar(32) | NOT NULL |        | ID       | PRIMARY KEY |          |
| note_id              | varchar(32) | NOT NULL |        | ç¬”è®°ID   | KEY         |          |
| user_id              | varchar(32) | NOT NULL |        | ç”¨æˆ·ID   | KEY         |          |
| collection_folder_id | varchar(32) | NOT NULL |        | æ”¶è—å¤¹ID | KEY         |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š              | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ----------------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | ç¬”è®°â€”æ”¶è—å¤¹å…³ç³»è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```sql
CREATE TABLE `note_user_collection` (
  `id` varchar(32) NOT NULL COMMENT 'ID',
  `note_id` varchar(32) NOT NULL COMMENT 'ç¬”è®°ID',
  `user_id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ·ID',
  `collection_folder_id` varchar(32) NOT NULL COMMENT 'æ”¶è—å¤¹ID',
  `is_deleted` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_note_id` (`note_id`),
  KEY `idx_collection_folder_id` (`collection_folder_id`),
  KEY `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3 COMMENT='ç¬”è®°â€”ç”¨æˆ·-æ”¶è—å¤¹å…³ç³»è¡¨';
```

<br>

##### ç¬”è®°è¯„è®ºè¡¨ï¼ˆnote_commentï¼‰

###### å­—æ®µ

| å­—æ®µå           | å­—æ®µç±»å‹        | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š                   | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜ |
| ---------------- | --------------- | -------- | ------ | ---------------------- | ----------- | -------- |
| id               | varchar(32)     | NOT NULL |        | è¯„è®ºID                 | PRIMARY KEY |          |
| note_id          | varchar(32)     | NOT NULL |        | ç¬”è®°ID                 | KEY         |          |
| user_id          | varchar(32)     | NOT NULL |        | ç”¨æˆ·IDï¼ˆè¯„è®ºå‘å¸ƒè€…IDï¼‰ | KEY         |          |
| nickname         | varchar(50)     | NOT NULL |        | ç”¨æˆ·æ˜µç§°               |             |          |
| avatar           | varchar(255)    | NOT NULL |        | ç”¨æˆ·å¤´åƒ               |             |          |
| content          | varchar(500)    | NOT NULL |        | è¯„è®ºå†…å®¹               |             |          |
| likes            | bigint unsigned | NOT NULL | 0      | ç‚¹èµæ•°                 |             |          |
| reply_count      | bigint unsigned | NOT NULL | 0      | å›å¤æ•°                 |             |          |
| reply_comment_id | varchar(32)     |          | NULL   | æ‰€å±è¯„è®ºID             |             |          |
| reply_nickname   | varchar(50)     |          | NULL   | è¢«å›å¤äººæ˜µç§°           |             |          |
| reply_user_id    | varchar(32)     |          | NULL   | è¢«å›å¤äººID             |             |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š       | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ---------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | ç¬”è®°è¯„è®ºè¡¨ |          |

###### å»ºè¡¨è¯­å¥

```sql
CREATE TABLE `note_comment` (
  `id` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL DEFAULT '' COMMENT 'è¯„è®ºID',
  `note_id` varchar(32) NOT NULL DEFAULT '' COMMENT 'ç¬”è®°id',
  `user_id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ·IDï¼ˆè¯„è®ºå‘å¸ƒè€…IDï¼‰',
  `nickname` varchar(50) NOT NULL COMMENT 'ç”¨æˆ·æ˜µç§°',
  `avatar` varchar(255) NOT NULL COMMENT 'ç”¨æˆ·å¤´åƒ',
  `content` varchar(500) NOT NULL COMMENT 'è¯„è®ºå†…å®¹',
  `likes` bigint unsigned NOT NULL DEFAULT '0' COMMENT 'ç‚¹èµæ•°',
  `reply_count` bigint unsigned NOT NULL DEFAULT '0' COMMENT 'å›å¤æ•°',
  `reply_comment_id` varchar(32) DEFAULT NULL COMMENT 'æ‰€å±è¯„è®º ID',
  `reply_nickname` varchar(50) DEFAULT NULL COMMENT 'è¢«å›å¤äººæ˜µç§°',
  `reply_user_id` varchar(32) DEFAULT NULL COMMENT 'ç”¨æˆ·IDï¼ˆè¯„è®ºå‘å¸ƒè€…IDï¼‰',
  `is_deleted` tinyint unsigned NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ç¬”è®°è¯„è®ºè¡¨';
```

###### æ³¨æ„

`è¢«å›å¤äººæ˜µç§° `ã€ `è¢«å›å¤äººID` ä¸ `æ‰€å±è¯„è®ºID` åˆ†å±äºä¸¤ä¸ªä¸åŒçš„è¯„è®ºï¼Œç±»ä¼¼ä¸‹å›¾ï¼š

![image-20220110223505674](img/image-20220110223505674.png)

<br>

##### â—ç¬”è®°æ ‡ç­¾è¡¨

```

```

<br>

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

# 3	ä»˜è´¹æ¨¡å—

## 3.3	æ•°æ®è¡¨

##### å¼€é€šä¼šå‘˜è®¢å•è¡¨ï¼ˆtransaction_member_orderï¼‰

###### å­—æ®µ

| å­—æ®µå      | å­—æ®µç±»å‹      | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š                            | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜ |
| ----------- | ------------- | -------- | ------ | ------------------------------- | ----------- | -------- |
| id          | varchar(32)   | NOT NULL |        | ID                              | PRIMARY KEY |          |
| order_no    | varchar(20)   | NOT NULL |        | è®¢å•å·ï¼Œç”±å¤–éƒ¨æ”¯ä»˜æ¥å£è¿”å›      | UNIQUE KEY  |          |
| user_id     | varchar(32)   | NOT NULL |        |                                 |             |          |
| description | varchar(100)  | NOT NULL |        | å•†å“æè¿°                        |             |          |
| total_fee   | decimal(10,2) | NOT NULL | 0.01   | è®¢å•é‡‘é¢ï¼ˆå•ä½ï¼šåˆ†ï¼‰            |             |          |
| pay_type    | tinyint       | NOT NULL |        | æ”¯ä»˜ç±»å‹ï¼ˆ1ï¼šå¾®ä¿¡ 2ï¼šæ”¯ä»˜å®ï¼‰   |             |          |
| status      | tinyint       |          | 0      | è®¢å•çŠ¶æ€ï¼ˆ0ï¼šæœªæ”¯ä»˜ 1ï¼šå·²æ”¯ä»˜ï¼‰ |             |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š           | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | -------------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | è¶…çº§ä¼šå‘˜è®¢å•è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```sql
CREATE TABLE `transaction_member` (
  `id` varchar(32) NOT NULL DEFAULT 'ID',
  `order_no` varchar(20) NOT NULL COMMENT 'è®¢å•å·',
  `user_id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ·id',
  `description` varchar(100) NOT NULL COMMENT 'å•†å“æè¿°',
  `total_fee` decimal(10,2) NOT NULL DEFAULT '0.01' COMMENT 'è®¢å•é‡‘é¢ï¼ˆåˆ†ï¼‰',
  `pay_type` tinyint NOT NULL COMMENT 'æ”¯ä»˜ç±»å‹ï¼ˆ1ï¼šå¾®ä¿¡ 2ï¼šæ”¯ä»˜å®ï¼‰',
  `status` tinyint NOT NULL DEFAULT '0' COMMENT 'è®¢å•çŠ¶æ€ï¼ˆ0ï¼šæœªæ”¯ä»˜ 1ï¼šå·²æ”¯ä»˜ï¼‰',
  
  `is_deleted` tinyint unsigned NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  
  PRIMARY KEY (`id`),
  UNIQUE KEY `ux_order_no` (`order_no`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ä¼šå‘˜è®¢å•è¡¨';
```

<br>

##### å¼€é€šä¼šå‘˜æ”¯ä»˜æ—¥å¿—è¡¨ï¼ˆtransaction_member_logï¼‰

###### å­—æ®µ

| å­—æ®µå         | å­—æ®µç±»å‹      | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š                          | ç´¢å¼•ç±»å‹ | è¡¥å……è¯´æ˜ |
| -------------- | ------------- | -------- | ------ | ----------------------------- | -------- | -------- |
| id             | varchar(32)   | NOT NULL |        | ID                            |          |          |
| order_no       | varchar(20)   | NOT NULL |        | è®¢å•å·                        |          |          |
| pay_time       | datetime      |          | NULL   | æ”¯ä»˜å®Œæˆæ—¶é—´                  |          |          |
| total_fee      | decimal(10,2) |          | 0.01   | æ”¯ä»˜é‡‘é¢ï¼ˆåˆ†ï¼‰                |          |          |
| transaction_id | varchar(30)   |          | NULL   | äº¤æ˜“æµæ°´å·                    |          |          |
| trade_state    | char(20)      |          | NULL   | äº¤æ˜“çŠ¶æ€                      |          |          |
| pay_type       | tinyint       | NOT NULL |        | æ”¯ä»˜ç±»å‹ï¼ˆ1ï¼šå¾®ä¿¡ 2ï¼šæ”¯ä»˜å®ï¼‰ |          |          |
| attr           | text          |          |        | å…¶ä»–å±æ€§                      |          |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š               | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ------------------ | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | è¶…çº§ä¼šå‘˜æ”¯ä»˜æ—¥å¿—è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```
CREATE TABLE `transaction_member_log` (
  `id` varchar(32) NOT NULL DEFAULT 'ID',
  `order_no` varchar(20) NOT NULL COMMENT 'è®¢å•å·',
  `pay_time` datetime DEFAULT NULL COMMENT 'æ”¯ä»˜å®Œæˆæ—¶é—´',
  `total_fee` decimal(10,2) NOT NULL DEFAULT '0.01' COMMENT 'æ”¯ä»˜é‡‘é¢ï¼ˆåˆ†ï¼‰',
  `transaction_id` varchar(30) DEFAULT NULL COMMENT 'äº¤æ˜“æµæ°´å·',
  `trade_state` char(20) DEFAULT NULL COMMENT 'äº¤æ˜“çŠ¶æ€',
  `pay_type` tinyint NOT NULL COMMENT 'æ”¯ä»˜ç±»å‹ï¼ˆ1ï¼šå¾®ä¿¡ 2ï¼šæ”¯ä»˜å®ï¼‰',
  `attr` text COMMENT 'å…¶ä»–å±æ€§',
  
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='ä¼šå‘˜æ”¯ä»˜æ—¥å¿—è¡¨';
```

<br>

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

# 4	å‰å°æ¨¡å—

### 4.1	åŠŸèƒ½å®ç°

##### æ ¹æ®å…³é”®å­—æœç´¢è¢«å‘å¸ƒçš„ç¬”è®°

- ä½¿ç”¨ ElasticSearch è¿›è¡Œæœç´¢

<br>

----

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

# 5	OSS æ¨¡å—

## 5.1	åŠŸèƒ½å®ç°

- ä½¿ç”¨é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨

<br>

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>
## 5.3	è¡¨è®¾è®¡

##### é˜¿é‡Œäº‘ oss èµ„æºç®¡ç†è¡¨ï¼ˆaliyun_oss_resourceï¼‰

###### å­—æ®µ

| å­—æ®µå    | å­—æ®µç±»å‹     | å¯ä¸ºç©º   | é»˜è®¤å€¼ | æ³¨é‡Š                                                         | ç´¢å¼•ç±»å‹    | è¡¥å……è¯´æ˜ |
| --------- | ------------ | -------- | ------ | ------------------------------------------------------------ | ----------- | -------- |
| id        | varchar(32)  | NOT NULL |        | ID                                                           | PRIMARY KEY |          |
| type      | tinyint      |          | NULL   | èµ„æºç±»å‹ï¼ˆ0ï¼šç”¨æˆ·å¤´åƒï¼Œ1ï¼šç¬”è®°å›¾ç‰‡ï¼Œ2ï¼šç¬”è®°å°é¢ï¼Œ3ï¼šå¾…å®šï¼Œ4ï¼šå¾…å®šï¼Œ5ï¼šå¾…å®šï¼‰ | KEY         |          |
| belong_id | varchar(32)  |          | NULL   | è¯¥èµ„æºçš„ä½¿ç”¨è€…IDï¼ˆä½¿ç”¨è€…å¯èƒ½ä¸ºç”¨æˆ·ï¼Œä¹Ÿå¯èƒ½ä¸ºç¬”è®°ï¼Œæˆ–è€…å…¶ä»–ï¼‰ | KEY         |          |
| src       | varchar(255) | NOT NULL |        | èµ„æºurlåœ°å€                                                  |             |          |
| in_use    | tinyint(1)   | NOT NULL | 0      | æ˜¯å¦åœ¨ä½¿ç”¨ä¸­ï¼š1ï¼ˆtrueï¼‰åœ¨ä½¿ç”¨ä¸­ï¼Œ 0ï¼ˆfalseï¼‰ä¸åœ¨ä½¿ç”¨ä¸­       | KEY         |          |
| deleted   | tinyint(1)   | NOT NULL | 0      | è¯¥å­—æ®µä¸ is _deleted å­—æ®µä¸åŒï¼Œè¡¨ç¤ºèµ„æºæ˜¯å¦å·²ç»åˆ é™¤ï¼š 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤ |             |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š                  | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | --------------------- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci | é˜¿é‡Œäº‘ oss èµ„æºç®¡ç†è¡¨ |          |

###### å»ºè¡¨è¯­å¥

```sql
CREATE TABLE `aliyun_oss_resource` (
  `id` varchar(32) NOT NULL COMMENT 'ID',
  `type` tinyint DEFAULT NULL COMMENT 'èµ„æºç±»å‹ï¼ˆ0ï¼šç”¨æˆ·å¤´åƒï¼Œ1ï¼šç¬”è®°å›¾ç‰‡ï¼Œ2ï¼šç¬”è®°å°é¢ï¼Œ3ï¼šå¾…å®šï¼Œ4ï¼šå¾…å®šï¼Œ5ï¼šå¾…å®šï¼‰',
  `belong_id` varchar(32) DEFAULT NULL COMMENT 'è¯¥èµ„æºçš„ä½¿ç”¨è€…IDï¼ˆä½¿ç”¨è€…å¯èƒ½ä¸ºç”¨æˆ·ï¼Œä¹Ÿå¯èƒ½ä¸ºç¬”è®°ï¼Œæˆ–è€…å…¶ä»–ï¼‰',
  `src` varchar(255) NOT NULL COMMENT 'èµ„æºurlåœ°å€',
  `in_use` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦åœ¨ä½¿ç”¨ä¸­ï¼š1ï¼ˆtrueï¼‰åœ¨ä½¿ç”¨ä¸­ï¼Œ 0ï¼ˆfalseï¼‰ä¸åœ¨ä½¿ç”¨ä¸­',
  `deleted` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'èµ„æºæ˜¯å¦å·²ç»åˆ é™¤ï¼š 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
    
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_type` (`type`),
  KEY `idx_belong_id` (`belong_id`),
  KEY `idx_in_use` (`in_use`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='é˜¿é‡Œäº‘ oss èµ„æºç®¡ç†è¡¨';
```

<br>

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

# 6	SMS æ¨¡å—

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

# 7	ç«™å†…æ¶ˆæ¯æ¨¡å—

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>

# 8	æ•°æ®åŒæ­¥æ¨¡å—

---

<div STYLE="page-break-after: always;">
    <br>
    <br>
    <br>
    <br>
    <br></div>
# é™„å½•

##### è¡¨è®¾è®¡æ¨¡æ¿


````
##### è¡¨ï¼ˆï¼‰

###### å­—æ®µ

| å­—æ®µå | å­—æ®µç±»å‹ | å¯ä¸ºç©º | é»˜è®¤å€¼ | æ³¨é‡Š | ç´¢å¼•ç±»å‹ | è¡¥å……è¯´æ˜ |
| ------ | -------- | ------ | ------ | ---- | -------- | -------- |
|        |          |        |        |      |          |          |

###### å»ºè¡¨å±æ€§

| æ•°æ®åº“å¼•æ“ | é»˜è®¤æ•°æ®ç¼–ç  | æ’åºè§„åˆ™           | æ³¨é‡Š | è¡¥å……è¯´æ˜ |
| ---------- | ------------ | ------------------ | ---- | -------- |
| InnoDB     | utf8mb4      | utf8mb4_0900_ai_ci |      |          |

###### å»ºè¡¨è¯­å¥

```
CREATE TABLE `` (
  `id` varchar(32) NOT NULL COMMENT 'ID',
  `is_deleted` tinyint unsigned NOT NULL DEFAULT '0' COMMENT 'é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤',
  `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `gmt_modified` datetime NOT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='';
```
````

##### ç¬¦å·è¯´æ˜

- â­•ï¼šå·²ç»å®Œæˆçš„ <u>åŠŸèƒ½</u> æˆ– <u>å®ç°æ–¹æ¡ˆ</u>
- â—ï¼šè®¡åˆ’æœ€è¿‘è¦å®ç°çš„åŠŸèƒ½
- ğŸ“Œï¼šç”±äºæŠ€æœ¯åŸå› æš‚æ—¶æ— æ³•å®ç°ï¼Œä½†æ˜¯è®¡åˆ’ä¹‹åè¦å®ç°çš„åŠŸèƒ½
- âŒï¼šæ”¾å¼ƒå®ç°çš„ <u>åŠŸèƒ½</u> æˆ– <u>å®ç°æ–¹æ¡ˆ</u>

